<div class="dashboard-prof">
  <!-- En-tête élégant avec fond gradient -->
  <div class="prof-header mb-4">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-md-6">
          <div class="d-flex align-items-center">
            <div class="avatar-container me-3">
              <div class="prof-avatar bg-gradient-primary">
                <i class="cil-education"></i>
              </div>
            </div>
            <div>
              <h1 class="prof-title mb-1">Tableau de bord</h1>
              <div class="prof-info">
                <span class="prof-name">{{ userPrenom }} {{ userNom }}</span>
                <span class="prof-badge">Professeur</span>
                <span class="prof-stats">
                  <i class="cil-school me-1"></i>{{ classes.length }} classes
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="prof-actions d-flex justify-content-end gap-2">
            <button class="btn btn-light btn-icon" routerLink="/prof/notes">
              <i class="cil-clipboard"></i>
              <span>Saisir notes</span>
            </button>
            <button class="btn btn-light btn-icon" routerLink="/prof/absences">
              <i class="cil-calendar"></i>
              <span>Gérer absences</span>
            </button>
            <button class="btn btn-light btn-icon" routerLink="/prof/messages">
              <i class="cil-envelope-open"></i>
              <span>Messages</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistiques principales -->
  <div class="container-fluid mb-4">
    <div class="row g-3">
      <div class="col-md-3 col-sm-6">
        <div class="stat-card stat-primary">
          <div class="stat-icon">
            <i class="cil-school"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ classes.length }}</div>
            <div class="stat-label">Classes assignées</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="stat-card stat-info">
          <div class="stat-icon">
            <i class="cil-people"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ getTotalEleves() }}</div>
            <div class="stat-label">Élèves total</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="stat-card stat-warning">
          <div class="stat-icon">
            <i class="cil-warning"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ getTotalAbsences() }}</div>
            <div class="stat-label">Absences total</div>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="stat-card stat-success">
          <div class="stat-icon">
            <i class="cil-chart"></i>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ messagesRecus.length }}</div>
            <div class="stat-label">Messages reçus</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Contenu principal -->
  <div class="container-fluid">
    <!-- Mes classes -->
    <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">
          <i class="cil-school me-2"></i>
          Mes classes
        </h5>
        <a routerLink="/prof/classes" class="btn btn-sm btn-outline-primary">
          Voir toutes <i class="cil-arrow-right ms-1"></i>
        </a>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div *ngFor="let classe of classes" class="col-md-4 col-sm-6">
            <div class="class-card">
              <div class="class-header">
                <h6 class="class-title">{{ classe.nom }}</h6>
                <div class="class-status">
                  <span class="badge bg-primary">Active</span>
                </div>
              </div>
              <div class="class-body">
                <div class="class-stats">
                  <div class="class-stat">
                    <i class="cil-user"></i>
                    <span>{{ classe.nombreEleves }} élèves</span>
                  </div>
                  <div class="class-stat">
                    <i class="cil-warning"></i>
                    <span>{{ classe.absences }} absences</span>
                  </div>
                </div>
                <div class="class-actions">
                  <button class="btn btn-sm btn-outline-primary w-100" [routerLink]="['/prof/classe', classe.id]">
                    <i class="cil-list me-1"></i>
                    Voir détails
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="classes.length === 0" class="col-12">
            <div class="empty-state text-center py-5">
              <div class="empty-icon mb-3">
                <i class="cil-school text-muted" style="font-size: 3rem;"></i>
              </div>
              <h5 class="text-muted">Aucune classe assignée</h5>
              <p class="text-muted mb-0">Vous n'avez pas encore de classes assignées.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Graphique et messages -->
    <div class="row g-4">
      <div class="col-lg-8">
        <div class="card h-100">
          <div class="card-header">
            <h5 class="card-title mb-0">
              <i class="cil-chart me-2"></i>
              Absences par classe
            </h5>
          </div>
          <div class="card-body">
            <div *ngIf="classes.length > 0" class="chart-container" style="height: 300px;">
              <c-chart type="bar" [data]="chartData.absences" [options]="chartOptions.absences"></c-chart>
            </div>
            <div *ngIf="classes.length === 0" class="empty-state text-center py-5">
              <p class="text-muted">Aucune donnée à afficher</p>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="card h-100">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-0">
              <i class="cil-envelope-open me-2"></i>
              Derniers messages
            </h5>
            <a routerLink="/prof/messages" class="btn btn-sm btn-outline-primary">
              Voir tous
            </a>
          </div>
          <div class="card-body p-0">
            <div class="messages-list">
              <div *ngFor="let message of messagesRecus" class="message-item">
                <div class="message-avatar">
                  {{ message.expediteur.charAt(0) }}
                </div>
                <div class="message-content">
                  <div class="message-header">
                    <strong class="message-sender">{{ message.expediteur }}</strong>
                    <small class="message-date text-muted">{{ formatDate(message.date) }}</small>
                  </div>
                  <p class="message-text mb-0">{{ message.message | slice:0:60 }}{{ message.message.length > 60 ? '...' : '' }}</p>
                </div>
              </div>
              <div *ngIf="messagesRecus.length === 0" class="empty-state text-center py-5">
                <div class="empty-icon mb-3">
                  <i class="cil-envelope-open text-muted" style="font-size: 2rem;"></i>
                </div>
                <p class="text-muted mb-0">Aucun message</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
